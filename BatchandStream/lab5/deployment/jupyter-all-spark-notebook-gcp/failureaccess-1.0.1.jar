RUN echo 'spark.jars.packages com.google.cloud.spark:spark-bigquery-with-dependencies_2.12:0.22.0,com.google.cloud.bigdataoss:gcs-connector:hadoop3-2.2.0' >> "${SPARK_HOME}/conf/spark-defaults.conf"
# Update the guava library needed by gcs connector
RUN mv ${SPARK_HOME}/jars/guava-14.0.1.jar ${SPARK_HOME}/jars/guava-14.0.1.jar.bk
COPY guava-30.1-jre.jar ${SPARK_HOME}/jars
COPY *.jar ${SPARK_HOME}/jars/

@@ -5,4 +5,4 @@ FROM bitnami/spark:3.1.1
COPY --from=build /opt/bitnami/python/ /opt/bitnami/python/
# Update the guava library needed by gcs connector
RUN mv /opt/bitnami/spark/jars/guava-14.0.1.jar /opt/bitnami/spark/jars/guava-14.0.1.jar.bk
COPY guava-30.1-jre.jar /opt/bitnami/spark/jars 
COPY *.jar /opt/bitnami/spark/jars/ 

